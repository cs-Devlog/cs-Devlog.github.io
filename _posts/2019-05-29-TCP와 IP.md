---
title: TCP/IP
date: 2019-05-29- 13:01:00
description: TCP/IP에 대해 알아보자
categories:
- Network
tags: 
- Network
- TCP
- IP
- 프로토콜
---
# 네트워크 용어
- 네트워크 : 컴퓨터끼리 정보를 주고 받을 수 있는 상태를 말한다. 
- 프로토콜 : 국가끼리 문제없이 교류할 수 있도록 정해진 규칙
- TCP/IP : 네트워크 상 송수신을 원할하게 수행하기 위한 규칙으로 데이터 송수신에 관한 일련의 작업을 하나로 모은 것
- 패킷    : 데이터 전송시 데이터를 일정 크기로 잘라서 보내는 방식으로, 보통 1 패킷 = 1024 비트이다.
- [**cf) OSI 7 계층**](https://cs-devlog.github.io/network/2019/05/22/OSI-7-Layer/)

***

# TCP/IP 작동 방식
1. **[송신자 A] 애플리케이션 층 (HTTP, SMTP, POP3, FTP)**
    - 애플리케이션간 데이터를 주고받기 위해 필요한 정보를 작성한다.
2. **[송신자 A] 트랜스포트 층 (TCP / UDP)**
    - 데이터를 패킷으로 나누고 애플리케이션을 나타내는 번호와 데이터 조합하기 위한 정보를 작성한다.
3. **[송신자 A] 네트워크 층 ( IP )**
    - 송수신할 컴퓨터 주소와 불명인 경우 데이터를 파기하는 표시 등을 작성한다.
4. **[송신자 A] 데이터링크 층 (Ethernet)**
    - 네트워크 종류에 맞춘 형식으로 수신지 정보 등을 작성한다.
5. **[송신자 A] 물리 층**
    - 비트열을 신호로 변환해 전송한다.
6. **[수신자 B] 물리 층**
    - 신호를 비트열로 변환한다.
7. **[수신자 B] 데이터링크 층 (Ethernet)**
    - 헤더에 적힌 정보를 확인하고 지정된 프로토콜에게 전달한다.
8. **[수신자 B] 네트워크 층 ( IP )**
    - 헤더에 적힌 수신처가 맞는지 확인하고 지정된 프로토콜에게 전달한다.
9. **[수신자 B] 트랜스포트 층 (TCP / UDP)**
    - 헤더를 확인하고 데이터를 순서대로 나열해 조합한다.
10. **[수신자 B] 애플리케이션 층 (HTTP, SMTP, POP3, FTP)**
    - 조합된 데이터를 확인한다.

***

# TCP/IP 4 계층 - 인터넷 모델
## < 응용 계층 >
- 컴퓨터끼리의 주고받기를 사용자가 이용할 수 있는 '통신 서비스' 형태로 만드는 것(서버/클라이언트)
- 애플리케이션 헤더 : 요청과 응답에 관한 정보가 들어있는 헤더
- HTTP 프로토콜 : 하나의 요청에 하나의 응답을 반환하고 연결을 해제하는 방법
- [**cf) HTTP 프로토콜과 Cookie/Session**](https://cs-devlog.github.io/network/2019/05/21/HTTP와-REST-API/)

## < 전송 계층 >
- 애플리케이션 층과 네트워크 층의 중개 역할을 수행
- TCP 프로토콜과 UDP 프로토콜이 존재한다. 
- [**cf) TCP/UDP 프로토콜 차이점**](https://cs-devlog.github.io/network/2019/05/22/TCP와-UDP/)

## < 인터넷 계층 >
- 누가 누구에게 전달할 지를 결정하는 주요 역할, 적절한 루트를 사용해 전달하는 역할(Router)
- IP 주소 : 인터넷 상의 컴퓨터들을 식별하기 위해 인터넷에 연결된 컴퓨터에 주어지는 숫자
- IP 프로토콜 : 비커넥션형 프로토콜로 UDP와 동일하다. 신뢰성 있는 IP를 지원하기 위해 ICMP 프로토콜이 있다.
- ICMP 프로토콜 : 수신인에게 전달되지 않는 등 문제 발생 시 송신자에게 그 사실을 알려주는 메세지를 전송한다.
- IP 데이터그램 : 트랜스포트 층으로부터 데이터를 받아 IP 헤더를 붙인 것
- Best Effort 방식 -> 노력은 하지만 결과는 보장하지 않는다.

## < 네트워크 인터페이스 계층 >
- 데이터 링크 안에서 데이터를 어떻게 주고받을지 결정하는 역할
- NIC(Network Interface Card)을 통해 비트열 <-> 신호 변환
- NIC에는 MAC 주소라는 고유 번호가 할당되어 있어 MAC 주소가 일치하는 경우에만 수신자 NIC에서 데이터를 받는다.
- 수신인의 IP 주소만 알고 MAC 주소를 모르는 경우 ARP(Address Resolution Protocol) 프로토콜을 활용한다.
    1. MAC 주소를 알고싶은 컴퓨터의 IP 주소를 ARP 패킷에 적고 브로드캐스트 MAC 주소 앞으로 보낸다.
    2. 자신의 IP 주소가 아니라면 파기하고, 자신의 IP 주소라면 MAC 주소를 적은 ARP 패킷을 송신자에게 보낸다.

### < CSMA 프로토콜 >
- 동시에 네트워크를 사용하고자 할 때 상호충돌을 방지하고자 전송 Bus에 흐르는 신호를 감지하는 프로토콜
- 노드 A에서 네트워크를 전송하기 전에 현재 채널을 사용 여부를 확인해 다중 접근을 방지하는 방법

### < CSMA/CD >
- 송신 전에 전송매체가 비어 있는지 확인하고(Carrier Sense), 비어 있으면 신호를 전송하고(Multiple Access), 전송 후에 충돌이 있는지 확인(Collision Detection) 하는 방식
- 데이터 프레임 간의 충돌이 발생하는 것을 보완하기 위해 CSMA 방식에 충돌 검증 + 재전송 기능 추가
- 모든 노드가 순서와 규칙 없이 경쟁하여 선로를 점유하는 방식으로 토큰 버스, 토큰 링은 각 노드에 차례로 점유할 기회를 주는 순차적 할당 방식
- 전송량이 적을 때 효율적이고 버스형 LAN에 가장 일반적으로 이용

1. 송신하기 전에 송신중인 다른 노드가 없는지 조사한다.
2. MAC 주소 b 앞으로 데이터를 전송한다.
3. 자기 앞으로 온 데이터일 경우 회수, 아닐 경우 파기한다.
4. 충돌을 감지했을 때는 잠시 후 다시 전송한다.

### <CSMA/CA >
- CSMA 방식 기반에 RTS와 CTS를 사전에 주고 받음으로써 전송할 시간을 미리 예약하여 충돌을 미연에 방지하는 방식

***